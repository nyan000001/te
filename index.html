<!DOCTYPE html>
<html>
<head>
<title>て</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">
<style>
* { font:14pt sans-serif; }
body, output, #input { width:170px; }
body { margin:auto; }
output, summary { text-align:center; }
output, #input, label { display:block; }
#input { border:1px solid #888; }
#input, details { margin:4px 0; }
summary { font-size:10pt; }
summary, label { cursor:pointer; }
div { column-count:2; }
@media (prefers-color-scheme:dark) {
	* { color:#fff; background:#000; }
	input[type=checkbox] { filter:invert(100%); }
}
</style>
</head>
<body>
<output id="kanji"></output>
<output id="kana"></output>
<input id="input">
<details>
<summary>Settings</summary>
<div>
<label><input type="checkbox" id="て" checked>て</label>
<label><input type="checkbox" id="って" checked>って</label>
<label><input type="checkbox" id="して">して</label>
<label><input type="checkbox" id="いて">いて</label>
<label><input type="checkbox" id="いで">いで</label>
<label><input type="checkbox" id="んで">んで</label>
</div>
</details>
<output id="score">0</output>
<script>
const verbs = {
	'て': [
		['くわえる', '加える'], ['みとめる', '認める'], ['こたえる', '答える'], ['あらわれる', '現れる'], ['さける', '避ける'], ['きんじる', '禁じる'], ['あびる', '浴びる'], ['いる', '居る'], ['できる', '出来る'], ['いきる', '生きる'], ['きこえる', '聞こえる'], ['うまれる', '生まれる'], ['おれる', '折れる'], ['こげる', '焦げる'], ['まける', '負ける'], ['はずれる', '外れる'], ['たりる', '足りる'], ['ぬける', '抜ける'], ['おくれる', '遅れる'], ['なまける', '怠ける'], ['もてる'], ['うれる', '売れる'], ['みえる', '見える'], ['よごれる', '汚れる'], ['ぬれる', '濡れる'], ['はじめる', '始める'], ['しんじる', '信じる'], ['まげる', '曲げる'], ['かりる', '借りる'], ['きれる', '切れる'], ['やぶれる'], ['たてる', '立てる'], ['やける', '焼ける'], ['かえる', '変える'], ['しらべる', '調べる'], ['はれる', '晴れる'], ['くずれる', '崩れる'], ['とれる', '取れる'], ['はずれる', '外れる'], ['ほどける', '解ける'], ['なぐさめる', '慰める'], ['いいつける', '言いつける'], ['くらべる', '比べる'], ['つづける', '続ける'], ['ひえる', '冷える'], ['かぞえる', '数える'], ['きめる', '決める'], ['さだめる', '定める'], ['とどける', '届ける'], ['わける'], ['たべる', '食べる'], ['すぐれる', '優れる'], ['たける', '長ける'], ['とりかえる', '取り換える'], ['たおれる', '倒れる'], ['ほれる', '惚れる'], ['おちる', '落ちる'], ['おそれる', '恐れる'], ['かんじる', '感じる'], ['みつける', '見つける'], ['かたづける', '片付ける'], ['ながれる', '流れる'], ['わすれる', '忘れる'], ['あつめる', '集める'], ['える', '得る'], ['こわれる', '壊れる'], ['きかえる', '着換える'], ['こえる'], ['おりる', '降りる'], ['つかれる', '疲れる'], ['おきる', '起きる'], ['なれる', '慣れる'], ['あげる', 'あげる'], ['くれる', '呉れる'], ['でる', '出る'], ['でかける', '出かける'], ['むかえる', '迎える'], ['はえる', '生える'], ['くれる', '暮れる'], ['かける', '掛ける'], ['たすける', '助ける'], ['さまたげる', '妨げる'], ['ぶつける'], ['かかえる', '抱える'], ['ふえる', '増える'], ['ふせる', '伏せる'], ['つれる', '連れる'], ['もれる', '漏れる'], ['よせる', '寄せる'], ['なめる', '舐める'], ['ならべる', '並べる'], ['みる', '見る'], ['やせる'], ['さげる', '下げる'], ['まちがえる', '間違える'], ['こしらえる', '拵える'], ['とける', '溶ける'], ['まぜる', '混ぜる'], ['しらせる', '知らせる'], ['あける', '開ける'], ['あわてる', '慌てる'], ['わかれる', '別れる'], ['すぎる', '過ぎる'], ['かさねる', '重ねる'], ['くわだてる', '企てる'], ['うえる'], ['ほめる', '褒める'], ['もうける', '儲ける'], ['いれる', '入れる'], ['のせる', '乗　せる'], ['かかげる', '掲げる'], ['おぼえる', '覚える'], ['もとめる', '求める'], ['にる', '似る'], ['おさえる', '抑える'], ['にげる', '逃げる'], ['たくわえる', '蓄える'], ['ためる'], ['はなれる', '離れる'], ['みせる', '見せる'], ['しめる', '閉める'], ['こしかける', '腰掛ける'], ['ねる', '寝る'], ['こぼれる'], ['ひろめる', '広める'], ['かまえる', '構える'], ['とめる', '止める'], ['やめる', '止める'], ['つよめる', '強める'], ['かためる', '固める'], ['ささえる', '支える'], ['ひきうける', '引き受ける'], ['おしえる', '教える'], ['いましめる', '戒める'], ['かんがえる', '考える'], ['なげる', '投げる'], ['すてる', '捨てる'], ['そだてる', '育てる'], ['いじめる', '虐める'], ['ふれる', '触れる'], ['のりかえる', '乗り換える'], ['つける', '点ける'], ['きえる', '消える'], ['ながめる', '眺める'], ['きる', '着る'], ['かれる', '枯れる'], ['つとめる', '勤める'], ['きずつける', '傷つける']
	],
	'って': [
		['ののしる', '罵る'], ['よる', ' 寄る'], ['はべる', '侍る'], ['ふける'], ['たまぎる', '魂消る'], ['くねる'], ['なおる', '直る'], ['きまる', '決まる'], ['ことなる', '異なる'], ['みつかる', '見つかる'], ['あぶらぎる', '脂ぎる'], ['あせる', '焦る'], ['こまる', '困る'], ['なくなる', '無くなる'], ['まじる', '混じる'], ['くつがえる'], ['かさなる', '重なる'], ['もうかる', '儲かる'], ['たすかる', '助かる'], ['たまる'], ['ぬめる'], ['びびる'], ['おとる', '劣る'], ['なる'], ['しける'], ['かげる'], ['かたまる', '固まる'], ['きしる'], ['はやる', '流行る'], ['つよまる', '強まる'], ['いきる'], ['はじまる', '始まる'], ['みくびる'], ['ひねる', '捻る'], ['のる', '乗る'], ['いばる', '威張る'], ['たぎる'], ['よみがえる'], ['かわる', '変わる'], ['しゃべる', '喋る'], ['だべる'], ['のぼる', '登る'], ['しまる', '閉まる'], ['くる', '来る'], ['まいる', '参る'], ['せる'], ['わたる', '渡る'], ['かしる'], ['きる', '切る'], ['おどる', '踊る'], ['おもいきる'], ['くさる', '腐る'], ['いつわる', '偽る'], ['かざる', '飾る'], ['へる', '減る'], ['たよる'], ['ほる', '掘る'], ['いやがる', '嫌がる'], ['わる'], ['やる'], ['する'], ['にじる'], ['おわる', '終わる'], ['はいる', '入る'], ['ねむる', '眠る'], ['のめる'], ['ふる', '降る'], ['さがる', '下がる'], ['ちる', '散る'], ['ひる'], ['こわがる', '怖がる'], ['めいる'], ['いじる'], ['つる', '釣る'], ['おもねる'], ['ほてる'], ['あつまる', '集まる'], ['おこる', '怒る'], ['くもる', '曇る'], ['ふとる', '太る'], ['あたたまる', '暖まる'], ['かじる', '齧る'], ['まわる', '回る'], ['とおる', '通る'], ['あがる', '上がる'], ['くじる'], ['こじる'], ['にぎる', '握る'], ['くびる'], ['しずまる', '静まる'], ['しげる'], ['ぐちる'], ['とばしる'], ['ほとばしる'], ['ある', '有る'], ['かくれる', '隠れる'], ['ぶつかる'], ['へりくだる'], ['やじる'], ['ける', '蹴る'], ['くわわる', '加わる'], ['しる', '知る'], ['のこる', '残る'], ['ふせる', '臥せる'], ['そべる'], ['かぎる', '限る'], ['かわいがる', '可愛がる'], ['つくる', '作る'], ['はかる'], ['どじる'], ['とちる'], ['いる', '要る'], ['おこる', '起こる'], ['みなぎる'], ['ぬる', '塗る'], ['もじる'], ['よぎる'], ['ほろびる', '滅びる'], ['せびる'], ['ほじる'], ['せせる'], ['つもる'], ['つめる'], ['つねる'], ['ちぎる'], ['むしる'], ['おもいいる'], ['いのる', '祈る'], ['まもる', '守る'], ['なぐる', '殴る'], ['なじる'], ['うけとる'], ['ことわる', '断わる'], ['もどる', '戻る'], ['かえる', '帰る'], ['あざける'], ['みのる', '実る'], ['はしる', '走る'], ['かける'], ['しかる', '叱る'], ['うる', '売る'], ['おくる', '送る'], ['てる'], ['ひかる', '光る'], ['すわる', '座る'], ['そしる'], ['すべる', '滑る'], ['ぬる', '塗る'], ['ひろまる', '広まる'], ['がんばる', '頑張る'], ['みはる', '見張る'], ['とまる', '泊まる'], ['はる', '張る'], ['とまる', '止まる'], ['だまる', '黙る'], ['かかわる', '関わる'], ['かかる', '掛かる'], ['とる', '取る'], ['やぶる'], ['ねる', '練る'], ['しばる', '縛る'], ['うわまわる'], ['いびる'], ['さわる', '触る'], ['よこぎる'], ['ひるがえる'], ['まがる', '曲がる'], ['ねじる', '捩じる'], ['よじる'], ['わかる', '分かる'], ['うねる'], ['ほしがる', '欲しがる'], ['かぶる', '被る'], ['まつる', '祀る'], ['もぎる'], ['すじる'],
		['おそう', '襲う'], ['ちがう', '違う'], ['まちがう', '間違う'], ['まよう', '迷う'], ['かう', '買う'], ['かまう', '構う'], ['いわう', '祝う'], ['おう', '追う'], ['くいちがう', '食い違う'], ['かよう', '通う'], ['はなしあう', ' 話し合う'], ['うたがう'], ['むかう', '向かう'], ['たたかう'], ['よう'], ['くるう', '狂う'], ['てつだう', '手伝う'], ['やとう'], ['すう', '吸う'], ['さそう', '誘う'], ['かう', '飼う'], ['わらう', '笑う'], ['ならう', '習う'], ['うしなう', '失う'], ['からかう'], ['あう', '合う'], ['あう', '会う'], ['はらう', '払う'], ['ひろう', '拾う'], ['かばう', '庇う'], ['しまう'], ['もらう', '貰う'], ['すくう', '救う'], ['いう', '言う'], ['うたう', '歌う'], ['かなう', '適う'], ['おもう', '思う'], ['つかう', '使う'], ['あらう', '洗う'], ['きづかう', '気遣う'],
		['めだつ', '目立つ'], ['そだつ', '育つ'], ['もつ', '持つ'], ['うつ'], ['たつ', '立つ'], ['まつ', '待つ'], ['かつ', '勝つ']
	],
	'して': [
		['たす', '足す'], ['こころざす', '志す'], ['こわす', '壊す'], ['わかす', '沸かす'], ['こらす', '凝らす'], ['ひやす', '冷やす'], ['こす', '越す'], ['まかす', '負かす'], ['よろこばす', '喜ばす'], ['いいあらわす', '言い表す'], ['くずす', '崩す'], ['ほろぼす', '滅ぼす'], ['おろす', '降ろす'], ['かわかす', '乾かす'], ['ほす', '干す'], ['はげます', '励ます'], ['だす', '出す'], ['ゆるす'], ['かえす', '返す'], ['はやす', '生やす'], ['わたす', '渡す'], ['かくす', '隠す'], ['ほのめかす', '仄めかす'], ['ふやす', '増やす'], ['しめす', '示す'], ['ころす', '殺す'], ['もらす', '漏らす'], ['のこす', '残す'], ['かす', '貸す'], ['にがす', '逃がす'], ['とおす', '通す'], ['からす', '枯らす'], ['くらす', '暮らす'], ['みなす', '見做す'], ['おとす', '落とす'], ['なくす', '無くす'], ['よごす', '污す'], ['じゅくす', '熟す'], ['とかす', '溶かす'], ['うごかす', '動かす'], ['みのがす', '見逃す'], ['たおす', '倒す'], ['うつす'], ['さす', '刺す'], ['のばす'], ['ながす', '流がす'], ['おす', '押す'], ['へらす', '減らす'], ['はずす', '外す'], ['なおす', '直す'], ['くりかえす', '繰り返す'], ['もどす', '戻す'], ['みたす', '満たす'], ['さがす', '探す'], ['はなす', '離す'], ['あらわす', '現す'], ['はなす', '話す'], ['すごす', '過ごす'], ['こぼす'], ['いいふらす', '言いふらす'], ['いいだす', '言い出す'], ['ひやかす', '冷やかす'], ['ためす', '試す'], ['だます', '騙す'], ['けす', '消す'], ['まわす', '回 わす'], ['おこす', '起こす']
	],
	'いて': [
		['つく', '着く'], ['やく', '焼く'], ['もとづく', '基づく'], ['おどろく', '驚く'], ['かわく', '乾く'], ['すく', '空く'], ['さく', '咲く'], ['ふく', '吹く'], ['わく', '沸く'], ['つづく', '続く'], ['くだく', '砕く'], ['なく', '泣く'], ['だく', '抱く'], ['ぬく', '抜く'], ['いく', '行く'], ['まねく', '招く'], ['かたむく', '傾く'], ['きく', '聞く'], ['うごく', '動く'], ['あく', '開く'], ['くどく', '口説く'], ['ひく', '弾く'], ['つく', '突く'], ['みがく', '磨く'], ['ひく', '引く'], ['はく', '履く'], ['おく', '置く'], ['とどく', '届く'], ['きづく', '気付く'], ['かがやく', '輝く'], ['とく', '解く'], ['しく', '敷く'], ['おもいつく', '思いつく'], ['ほどく', '解く'], ['あるく', '歩く'], ['はたらく', '働く'], ['かく', '書く']
	],
	'いで': [
		['つぐ', '次ぐ'], ['かつぐ', '担ぐ'], ['つなぐ'], ['あおぐ', '仰ぐ'], ['いそぐ', '急ぐ'], ['さわぐ', '騒ぐ'], ['かせぐ', '稼ぐ'], ['およぐ', '泳ぐ'], ['ぬぐ', '脱ぐ']
	],
	'んで': [
		['しぬ', '死ぬ'],
		['くらむ', '眩む'], ['かなしむ', '悲しむ'], ['うらむ'], ['かすむ', '霞む'], ['こむ', '込む'], ['いたむ', '痛む'], ['かむ', '噛む'], ['はさむ', '挟む'], ['のむ', '飲む'], ['たのしむ', '楽しむ'], ['しずむ', '沈む'], ['たたむ', '畳む'], ['なじむ', '馴染む'], ['にらむ', '睨む'], ['すすむ', '進む'], ['つかむ'], ['このむ', '好む'], ['すむ', '住む'], ['たくらむ', '企む'], ['うむ'], ['よむ', '読む'], ['おしむ', '惜しむ'], ['たのむ', '頼む'], ['やすむ', '休む'], ['ぬすむ', '盗む'], ['ふむ', '踏む'], ['はげむ', '励む'], ['くるしむ', '苦しむ'], ['かこむ', '囲む'], ['くむ', '組む'], ['つつむ', '包む'],
		['よろこぶ', '喜ぶ'], ['よぶ', '呼ぶ'], ['はこぶ', '運ぶ'], ['えらぶ', '選ぶ'], ['ころぶ', '転ぶ'], ['うかぶ'], ['ならぶ', '並ぶ'], ['とぶ', '飛ぶ'], ['まなぶ', '学ぶ'], ['あそぶ', '遊ぶ'], ['およぶ', '及ぶ'], ['むすぶ', '結ぶ']
	]
};
function convert(text) {
	text = text.toLowerCase();
	let obj = {
		'([ksthyrwgzjdbp])(?=\\1)|[ct](?=c|t)':'xtu',
		'n(?=[kstnchmyrwgzjdbp])':'ん',
		'm(?=p|m)':'ん',
		'l':'x',
		'tsu':'tu',
		'fu':'hu',
		'dzu':'du',
		'sh([aiueo])':'sy$1',
		'ch([aiueo])':'ty$1',
		'j([aiueo])':'zy$1',
		'dj([aiueo])':'dy$1',
		'yi':'i',
		'([kstnhmrgzdbp])y([auo])':'$1ixy$2'
	};
	for(const mora in obj) {
		text = text.replace(RegExp(mora, 'g'), obj[mora]);
	}
	obj = {
		'xtu':'っ',
		'xya':'ゃ', 'xyu':'ゅ', 'xyo':'ょ',
		'xa':'ぁ', 'xi':'ぃ', 'xu':'ぅ', 'xe':'ぇ', 'xo':'ぉ',

		'ka':'か', 'ki':'き', 'ku':'く', 'ke':'け', 'ko':'こ',
		'sa':'さ', 'si':'し', 'su':'す', 'se':'せ', 'so':'そ',
		'ta':'た', 'ti':'ち', 'tu':'つ', 'te':'て', 'to':'と',
		'na':'な', 'ni':'に', 'nu':'ぬ', 'ne':'ね', 'no':'の',
		'ha':'は', 'hi':'ひ', 'hu':'ふ', 'he':'へ', 'ho':'ほ',
		'ma':'ま', 'mi':'み', 'mu':'む', 'me':'め', 'mo':'も',
		'ya':'や', 'yu':'ゆ', 'yo':'よ',
		'ra':'ら', 'ri':'り', 'ru':'る', 're':'れ', 'ro':'ろ',
		'wa':'わ', 'wo':'を',
		'ga':'が', 'gi':'ぎ', 'gu':'ぐ', 'ge':'げ', 'go':'ご',
		'za':'ざ', 'zi':'じ', 'zu':'ず', 'ze':'ぜ', 'zo':'ぞ',
		'da':'だ', 'di':'ぢ', 'du':'づ', 'de':'で', 'do':'ど',
		'ba':'ば', 'bi':'び', 'bu':'ぶ', 'be':'べ', 'bo':'ぼ',
		'pa':'ぱ', 'pi':'ぴ', 'pu':'ぷ', 'pe':'ぺ', 'po':'ぽ',

		'a':'あ', 'i':'い', 'u':'う', 'e':'え', 'o':'お'
	};
	for(const mora in obj) {
		text = text.replaceAll(mora, obj[mora]);
	}
	return text.replaceAll('\'', '');
}
const kanji = document.getElementById('kanji');
const kana = document.getElementById('kana');
const input = document.getElementById('input');
let score = 0;
let answer;
let suffix;
const random = arr => arr[~~(arr.length*Math.random())];
const ask = () => {
	input.disabled = false;
	input.value = '';
	input.focus();
	let suffixes = [...document.querySelectorAll(':checked')].map(x => x.id);
	if(!suffixes.length) {
		kanji.value = kana.value = ' ';
		answer = '';
		return;
	} else if(suffixes.length > 1) {
		suffixes = suffixes.filter(x => x != suffix);
	}
	suffix = random(suffixes);
	[kana.value, kanji.value = ' '] = random(verbs[suffix]);
	answer = kana.value.slice(0, -1)+suffix;
}
ask();
oninput = e => {
	if(e.target == input) {
		const index = input.selectionStart;
		const a = convert(input.value.slice(0, index));
		const b = convert(input.value.slice(index));
		input.value = a+b;
		input.setSelectionRange(a.length, a.length);
		if(input.value == answer) {
			document.getElementById('score').value = ++score;
			input.disabled = true;
			setTimeout(ask, 500);
		}
	} else if(kana.value == ' ' || (e.target.id == suffix && !e.target.checked)) {
		ask();
	} else {
		input.focus();
	}
}
onkeydown = e => {
	if(e.key == 'Enter') {
		input.value = answer;
		input.disabled = true;
		setTimeout(ask, 1800);
	}
}
</script>
</body>
</html>
